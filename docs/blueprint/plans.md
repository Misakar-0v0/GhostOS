# 开发思路流水账

## 2024-04-17

1. 设计原型.
2. 实现一个 chat completion 的测试工具. 考虑使用 moonshot 等 cn 的模型来做测试.
  - 好像有一些开源库更适合做测试? 
    - 最好用自己的库. 方便未来做功能, 还可以开源. 但也需要借鉴开源项目, 而且不能做得太复杂了.
    - 自己的库可以作为未来大模型的工具被使用. 

自然语言 interface 的思路: 

```markdown
API:
+ moos: 面向模型的操作系统.
对象: 
+ self: 当前自身可用的 api
  + agents: 
```

API 和对象结合到一起的话, 需要定义几种不同的前缀: 
- `+`: 用来定义模块
- `-`: 用来定义实例, 同时是模块的属性.
- `*`: 用来定义模块的 methods, 但不是实例的. 

实例的数据需要被 moos api 去查看. 看起来 markdown 形式比 yaml 形式表现力更好. 

一个关键的难点是如何定义复杂的参数. 如果一个参数本身又是一个结构体, 这样情况就复杂了. 
不过有一个办法就是让模型和任务之间进行多轮对话. 哈哈哈. 
task 可以要求模型补齐入参所需要的额外信息. 从而和 agent 进行对话. 这样做的缺点是模型经常要重新从上下文里学习. 

未来模型应该可以实现快速学习. 会有比 sft 更合适的 interface.

# 确定的设计

- 流式输出: 以流式输出为基础, 非流式输出无法用于工业环境. 
- 自然语言函数 interface: 用 markdown 表示的自然语言树来定义函数体系, 支持 LLM 调用自然语言函数.
- python runtime: 自然语言函数运行的时候, 使用 python 的运行时. 
  - python 的运行时可能使用脚本进程来实现. 不一定是持久化进程. 
  - ghost runtime 和 python runtime 分开
- shell runtime(?) : 理论上要支持 shell, 但是也不一定吧. 
- 根据对话历史构建脚本: 对话历史 (Thread) 可以用来构建一个可执行的脚本. main 方法可以用 eval 去执行.
  - 对话历史考虑定义成 _chat.yml 文件. 可以被 moos 执行. 

# 确定需要做的 LLM 实验

- 可分段的流式输出. 
- 自然语言函数 interface.
- 基于自然语言调用, 翻译成 python 执行代码. 

# 确定要开发的功能模块

- python runtime. 好像用脚本语言就 ok 了? 但是要支持流式输出. 需要脚本化. 
- ghost runtime. 需要一个持久的进程. 
- shell, 与 ghost 进行通讯.
- 基于文件来构建的知识体系. 
